{{define "title"}}[{{.Issue.Key}}] {{.Issue.Summary}}{{end}}

{{define "content"}}
<div class="issue">
  <div class="issue-top">
    <div class="issue-title">
      <div class="issue-key" onclick="navigator.clipboard.writeText('{{.Issue.Key}}')">
        <img src="/static/icons/bug.svg" alt="">
        <span>{{.Issue.Key}}</span>
      </div>

      <h1 class="issue-summary">
        {{.Issue.Summary}}
      </h1>
    </div>
    <div class="issue-actions">
      <div class="issue-status">
        <div class="issue-status-button {{if .Issue.IsResolved}}issue-resolved{{end}}">
          {{.Issue.Status}}
        </div>
        {{.Issue.Resolution}}
      </div>
    </div>
  </div>

  <div class="issue-split">
    <main class="issue-body">
      <div class="issue-description">
        <div class="adf">{{RenderADF .Issue.Description}}</div>
      </div>
      {{if .Issue.HasEnvironment}}
      <h2>Environment</h2>
      <div class="adf">{{RenderADF .Issue.Environment}}</div>
      {{end}}
      {{if .Issue.Links}}
        <h2>Related issues</h2>
        <div>
          {{range .Issue.Links}}
            <div class="issue-link">{{.Type}} <a href="/{{.OtherKey}}">{{.OtherKey}}</a>: {{.OtherSummary}}</div>
          {{end}}
        </div>
      {{end}}
      {{if .Issue.Attachments}}
        <h2>Attachments</h2>
        <div class="attachments">
          {{range .Issue.Attachments}}
            <a class="attachment" href="https://bugs.mojang.com/api/issue-attachment-get?attachmentId={{.Id}}" target="_blank">
              {{if .IsImage}}
                <img src="https://bugs.mojang.com/api/issue-attachment-get?attachmentId={{.Id}}" alt="{{.Filename}}" loading="lazy" />
              {{else}}
                <div class="attachment-nopreview">{{.Filename}}</div>
              {{end}}
            </a>
          {{end}}
        </div>
      {{end}}
      <h2>Comments</h2>
      {{range .Issue.Comments}}
        <div>
          <div>
            {{if .AuthorAvatar}}
            <img class="avatar" src="{{.AuthorAvatar}}">
            {{end}}
            <strong>{{.AuthorName}}</strong>
            <time class="comment-time" datetime="{{FormatTime .Date}}">{{FormatTime .Date}}</time>
            <!-- <button onclick="navigator.clipboard.writeText(this.dataset.adf)" data-adf='{{.AdfComment | html}}' style="cursor:pointer;margin-left:0.5em;">ðŸ“‹</button> -->
          </div>
          <div class="comment-body adf">{{RenderADF .AdfComment}}</div>
        </div>
      {{else}}
        <p>No comments.</p>
      {{end}}
    </main>

    <div class="issue-details">
      <p><label>Reporter:</label>
        {{if .Issue.ReporterAvatar}}
          <img class="avatar" src="{{.Issue.ReporterAvatar}}">
        {{end}}
        {{.Issue.ReporterName}}
      </p>
      <p><label>Assignee:</label>
        {{if .Issue.AssigneeAvatar}}
          <img class="avatar" src="{{.Issue.AssigneeAvatar}}">
        {{end}}
        {{if .Issue.AssigneeName}}
        {{.Issue.AssigneeName}}
        {{else}}
        (Unassigned)
        {{end}}
      </p>
      <p><label>Created:</label> <time datetime="{{FormatTime .Issue.CreatedDate}}">{{FormatTime .Issue.CreatedDate}}</time></p>
      <p><label>Updated:</label> <time datetime="{{FormatTime .Issue.UpdatedDate}}">{{FormatTime .Issue.UpdatedDate}}</time></p>
      {{if .Issue.ResolvedDate}}
      <p><label>Resolved:</label> <time datetime="{{FormatTime .Issue.ResolvedDate}}">{{FormatTime .Issue.ResolvedDate}}</time></p>
      {{end}}
      {{if .Issue.IsProject "MC" "MCPE"}}
      <p><label>ADO:</label> {{.Issue.ADO}}</p>
      {{end}}
      <p><label>Votes:</label> {{.Issue.Votes}}</p>
      <p><label>Confirmation Status:</label> {{.Issue.ConfirmationStatus}}</p>
      {{if .Issue.IsProject "MCPE"}}
      <p><label>Platform:</label> {{.Issue.Platform}}</p>
      <p><label>OS Version:</label> {{.Issue.OSVersion}}</p>
      {{end}}
      {{if .Issue.IsProject "REALMS"}}
      <p><label>Realms Platform:</label> {{.Issue.RealmsPlatform}}</p>
      {{end}}
      {{if .Issue.IsProject "MC"}}
      <p><label>Area:</label> {{.Issue.Area}}</p>
      {{end}}
      {{if .Issue.IsProject "WEB"}}
      <p><label>Components:</label> {{.Issue.Components}}</p>
      {{end}}
      {{if .Issue.IsProject "MC"}}
      <p><label>Mojang Priority:</label> {{.Issue.MojangPriority}}</p>
      <p><label>Category:</label> {{.Issue.Category}}</p>
      {{end}}
      <p><label>Labels:</label> {{.Issue.Labels}}</p>
      {{if .Issue.IsProject "MC" "MCPE"}}
      <p><label>Affects Versions:</label> {{.Issue.ShortAffectedVersions}}</p>
      <p><label>Fix Versions:</label> {{.Issue.FixVersions}}</p>
      {{end}}
    </div>
  </div>
</div>
{{end}}

{{template "base" .}}
